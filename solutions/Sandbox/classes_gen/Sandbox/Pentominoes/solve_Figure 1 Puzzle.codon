# Solver generated using plaintextgen
import time
import sys
INT_BITS: Static[int] = 30
aspects = ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29",]
e = [["0","1","2","3","5","25",],["0","1","2","3","8","25",],["0","1","2","5","6","26",],["0","1","2","5","7","28",],["0","1","2","6","7","26",],["0","1","2","6","11","27",],["0","1","5","6","7","26",],["0","1","5","6","10","26",],["0","1","5","6","11","26",],["0","1","5","10","11","28",],["0","1","5","10","15","25",],["0","1","6","10","11","28",],["0","1","6","11","16","25",],["0","2","5","6","7","28",],["0","5","6","7","8","25",],["0","5","6","7","10","27",],["0","5","6","10","11","26",],["0","5","10","15","16","25",],["1","2","3","4","6","25",],["1","2","3","4","9","25",],["1","2","3","6","7","26",],["1","2","3","6","8","28",],["1","2","3","7","8","26",],["1","2","3","7","12","27",],["1","2","5","6","7","26",],["1","2","6","7","8","26",],["1","2","6","7","11","26",],["1","2","6","7","12","26",],["1","2","6","11","12","28",],["1","2","6","11","16","25",],["1","2","7","11","12","28",],["1","2","7","12","17","25",],["1","3","6","7","8","28",],["1","5","6","7","11","29",],["1","5","6","10","11","26",],["1","6","7","8","9","25",],["1","6","7","8","11","27",],["1","6","7","11","12","26",],["1","6","10","11","12","27",],["1","6","11","15","16","25",],["1","6","11","16","17","25",],["2","3","4","7","8","26",],["2","3","4","7","9","28",],["2","3","4","8","9","26",],["2","3","4","8","13","27",],["2","3","6","7","8","26",],["2","3","7","8","9","26",],["2","3","7","8","12","26",],["2","3","7","8","13","26",],["2","3","7","12","13","28",],["2","3","7","12","17","25",],["2","3","8","12","13","28",],["2","3","8","13","18","25",],["2","4","7","8","9","28",],["2","5","6","7","12","27",],["2","6","7","8","12","29",],["2","6","7","11","12","26",],["2","7","8","9","12","27",],["2","7","8","12","13","26",],["2","7","11","12","13","27",],["2","7","12","16","17","25",],["2","7","12","17","18","25",],["3","4","7","8","9","26",],["3","4","8","9","13","26",],["3","4","8","9","14","26",],["3","4","8","13","14","28",],["3","4","8","13","18","25",],["3","4","9","13","14","28",],["3","4","9","14","19","25",],["3","5","6","7","8","25",],["3","6","7","8","13","27",],["3","7","8","9","13","29",],["3","7","8","12","13","26",],["3","8","9","13","14","26",],["3","8","12","13","14","27",],["3","8","13","17","18","25",],["3","8","13","18","19","25",],["4","6","7","8","9","25",],["4","7","8","9","14","27",],["4","8","9","13","14","26",],["4","9","14","18","19","25",],["5","6","7","8","10","25",],["5","6","7","8","13","25",],["5","6","7","10","11","26",],["5","6","7","10","12","28",],["5","6","7","11","12","26",],["5","6","7","11","16","27",],["5","6","10","11","12","26",],["5","6","10","11","15","26",],["5","6","10","11","16","26",],["5","6","10","15","16","28",],["5","6","10","15","20","25",],["5","6","11","15","16","28",],["5","6","11","16","21","25",],["5","7","10","11","12","28",],["5","10","11","12","13","25",],["5","10","11","12","15","27",],["5","10","11","15","16","26",],["5","10","15","20","21","25",],["6","7","8","9","11","25",],["6","7","8","9","14","25",],["6","7","8","11","12","26",],["6","7","8","11","13","28",],["6","7","8","12","13","26",],["6","7","8","12","17","27",],["6","7","10","11","12","26",],["6","7","11","12","13","26",],["6","7","11","12","16","26",],["6","7","11","12","17","26",],["6","7","11","16","17","28",],["6","7","11","16","21","25",],["6","7","12","16","17","28",],["6","7","12","17","22","25",],["6","8","11","12","13","28",],["6","10","11","12","16","29",],["6","10","11","15","16","26",],["6","11","12","13","14","25",],["6","11","12","13","16","27",],["6","11","12","16","17","26",],["6","11","15","16","17","27",],["6","11","16","20","21","25",],["6","11","16","21","22","25",],["7","8","9","12","13","26",],["7","8","9","12","14","28",],["7","8","9","13","14","26",],["7","8","9","13","18","27",],["7","8","11","12","13","26",],["7","8","12","13","14","26",],["7","8","12","13","17","26",],["7","8","12","13","18","26",],["7","8","12","17","18","28",],["7","8","12","17","22","25",],["7","8","13","17","18","28",],["7","8","13","18","23","25",],["7","9","12","13","14","28",],["7","10","11","12","17","27",],["7","11","12","13","17","29",],["7","11","12","16","17","26",],["7","12","13","14","17","27",],["7","12","13","17","18","26",],["7","12","16","17","18","27",],["7","12","17","21","22","25",],["7","12","17","22","23","25",],["8","9","12","13","14","26",],["8","9","13","14","18","26",],["8","9","13","14","19","26",],["8","9","13","18","19","28",],["8","9","13","18","23","25",],["8","9","14","18","19","28",],["8","9","14","19","24","25",],["8","10","11","12","13","25",],["8","11","12","13","18","27",],["8","12","13","14","18","29",],["8","12","13","17","18","26",],["8","13","14","18","19","26",],["8","13","17","18","19","27",],["8","13","18","22","23","25",],["8","13","18","23","24","25",],["9","11","12","13","14","25",],["9","12","13","14","19","27",],["9","13","14","18","19","26",],["9","14","19","23","24","25",],["10","11","12","13","15","25",],["10","11","12","13","18","25",],["10","11","12","15","16","26",],["10","11","12","15","17","28",],["10","11","12","16","17","26",],["10","11","12","16","21","27",],["10","11","15","16","17","26",],["10","11","15","16","20","26",],["10","11","15","16","21","26",],["10","11","15","20","21","28",],["10","11","16","20","21","28",],["10","12","15","16","17","28",],["10","15","16","17","18","25",],["10","15","16","17","20","27",],["10","15","16","20","21","26",],["11","12","13","14","16","25",],["11","12","13","14","19","25",],["11","12","13","16","17","26",],["11","12","13","16","18","28",],["11","12","13","17","18","26",],["11","12","13","17","22","27",],["11","12","15","16","17","26",],["11","12","16","17","18","26",],["11","12","16","17","21","26",],["11","12","16","17","22","26",],["11","12","16","21","22","28",],["11","12","17","21","22","28",],["11","13","16","17","18","28",],["11","15","16","17","21","29",],["11","15","16","20","21","26",],["11","16","17","18","19","25",],["11","16","17","18","21","27",],["11","16","17","21","22","26",],["11","16","20","21","22","27",],["12","13","14","17","18","26",],["12","13","14","17","19","28",],["12","13","14","18","19","26",],["12","13","14","18","23","27",],["12","13","16","17","18","26",],["12","13","17","18","19","26",],["12","13","17","18","22","26",],["12","13","17","18","23","26",],["12","13","17","22","23","28",],["12","13","18","22","23","28",],["12","14","17","18","19","28",],["12","15","16","17","22","27",],["12","16","17","18","22","29",],["12","16","17","21","22","26",],["12","17","18","19","22","27",],["12","17","18","22","23","26",],["12","17","21","22","23","27",],["13","14","17","18","19","26",],["13","14","18","19","23","26",],["13","14","18","19","24","26",],["13","14","18","23","24","28",],["13","14","19","23","24","28",],["13","15","16","17","18","25",],["13","16","17","18","23","27",],["13","17","18","19","23","29",],["13","17","18","22","23","26",],["13","18","19","23","24","26",],["13","18","22","23","24","27",],["14","16","17","18","19","25",],["14","17","18","19","24","27",],["14","18","19","23","24","26",],["15","16","17","18","20","25",],["15","16","17","18","23","25",],["15","16","17","20","21","26",],["15","16","17","20","22","28",],["15","16","17","21","22","26",],["15","16","20","21","22","26",],["15","17","20","21","22","28",],["15","20","21","22","23","25",],["16","17","18","19","21","25",],["16","17","18","19","24","25",],["16","17","18","21","22","26",],["16","17","18","21","23","28",],["16","17","18","22","23","26",],["16","17","20","21","22","26",],["16","17","21","22","23","26",],["16","18","21","22","23","28",],["16","21","22","23","24","25",],["17","18","19","22","23","26",],["17","18","19","22","24","28",],["17","18","19","23","24","26",],["17","18","21","22","23","26",],["17","18","22","23","24","26",],["17","19","22","23","24","28",],["18","19","22","23","24","26",],["18","20","21","22","23","25",],["19","21","22","23","24","25",],]
encoding = {a:UInt[INT_BITS](UInt[INT_BITS](1) << UInt[INT_BITS](i)) for i,a in enumerate(aspects)}
decoding = {UInt[INT_BITS](UInt[INT_BITS](1) << UInt[INT_BITS](i)):a for i,a in enumerate(aspects)}
encode = lambda e: sum([encoding[k] for k in e], UInt[INT_BITS](0))
decode = lambda i: [decoding[UInt[INT_BITS](UInt[INT_BITS](1) << UInt[INT_BITS](j))] for j in range(len(aspects)) if UInt[INT_BITS](UInt[INT_BITS](1) << UInt[INT_BITS](j)) & i]
encodedEmbeddings = [encode(ee) for ee in e]
embeddings = [decode(ee) for ee in set(encodedEmbeddings)]

A = (UInt[INT_BITS](UInt[INT_BITS](1) << UInt[INT_BITS]((len(aspects)))) - UInt[INT_BITS](1))
E = sorted(list(set(encodedEmbeddings)), reverse=True)
print(len(E), "embeddings")
p = UInt[INT_BITS](0)
S = []
t = UInt[INT_BITS](-1)
counter = 0
visits = 0
S.append((p, [e for e in E if p & e == UInt[INT_BITS](0)], t))
print("Solving Figure 1 Puzzle bitwise...")
seconds = time.time()
while len(S) > 0:
    visits += 1
    pp, EE, t = S[-1]
    S.pop()
    if pp == A:
        counter += 1
        print(f"\r{counter}", end="")
        sys.stdout.flush()
    elif len(EE) > 0:
        # Zero-fit-cutoff (methode 2 Tonneijk)
        c = pp
        for e in EE:
            if e & pp == UInt[INT_BITS](0):
                c = e | c
        if c != A:
            continue # prune
        e = EE[0]
        if e & pp == UInt[INT_BITS](0):
            S.append((pp, EE[1:], t))
            S.append((pp | e, [ee for ee in EE[1:] if (pp | e) & ee == UInt[INT_BITS](0)], e))
        else:
            assert False

print(f"\rFound {counter} solutions in {time.time() - seconds} seconds while visiting {visits} nodes.")
